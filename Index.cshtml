
@{
    ViewData["Title"] = "Index";
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome | Aladdin - Find Services Providers Near You</title>
    <meta name="title" content="Aladdin - Find Services Providers Near You">
    <meta name="description" content="Aladdin is platfor for technical and skilled people to explore and offer their services to potential customers in their areas" />
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Aladdin - Find Services Providers Near You" />
    <meta property="og:url" content="https://aladdin.com.pk/" />
    <meta property="og:image" content="https://aladdin.com.pk/images/logo.png" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Aladdin is platfor for technical and skilled people to explore and offer their services to potential customers in their areas" />
    <meta property="og:locale" content="en_GB" />
    <link rel="icon" type="image/x-icon" href="~/favicon.ico">
</head>
<body>
    <header>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link href="~/style.css" rel="stylesheet" />
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js'></script>
        <script src='https://maps.googleapis.com/maps/api/js?key=AIzaSyAlQUvwpIS_6NdR01E8vHJDk3Z6h8hXNns'></script>
        <script src="./script.js"></script>
        <script src="~/script.js"></script>
    </header>
    <section class="form-box">
        <div class="container">

            <div class="row">
                <div class="col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3 form-wizard">

                    <!-- Form Wizard -->
                    <form role="form" action="" method="post">

                        <h3>Aladdin Basic Business Information</h3>
                        <p>Fill all form field to go next step</p>

                        <!-- Form progress -->
                        <div class="form-wizard-steps form-wizard-tolal-steps-4">
                            <div class="form-wizard-progress">
                                <div class="form-wizard-progress-line" data-now-value="12.25" data-number-of-steps="4" style="width: 12.25%;"></div>
                            </div>
                            <!-- Step 1 -->
                            <div class="form-wizard-step active">
                                <div class="form-wizard-step-icon"><i class="fa fa-user" aria-hidden="true"></i></div>
                                <p>Personal</p>
                            </div>
                            <!-- Step 1 -->
                            <!-- Step 2 -->
                            <div class="form-wizard-step">
                                <div class="form-wizard-step-icon"><i class="fa fa-location-arrow" aria-hidden="true"></i></div>
                                <p>Address</p>
                            </div>
                            <!-- Step 2 -->
                            <!-- Step 3 -->
                            <div class="form-wizard-step">
                                <div class="form-wizard-step-icon"><i class="fa fa-briefcase" aria-hidden="true"></i></div>
                                <p>Media</p>
                            </div>
                            <!-- Step 3 -->
                            <!-- Step 4 -->
                            <div class="form-wizard-step">
                                <div class="form-wizard-step-icon"><i class="fa fa-money" aria-hidden="true"></i></div>
                                <p>Payment</p>
                            </div>
                            <!-- Step 4 -->
                        </div>
                        <!-- Form progress -->
                        <!-- Form Step 1 -->
                        <fieldset>
                            <h4>Personal Information: <span>Step 1 - 4</span></h4>
                            <div class="form-group">
                                <label>Work Name: <span>*</span></label>
                                <input type="text" name="WorkName" placeholder="Work Name" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Focal Person Name: <span>*</span></label>
                                <input type="text" name="FocalPersonName" placeholder="Focal Person Name" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Phone: <span>*</span></label>
                                <input type="text" name="Phone" placeholder="Phone Number" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="email" name="Email" placeholder="Email if any" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Website: </label>
                                <input type="text" name="Website" placeholder="Website if any" class="form-control required">
                            </div>
                            <div class="form-wizard-buttons">
                                <button type="button" class="btn btn-next">Next</button>
                            </div>
                        </fieldset>
                        <!-- Form Step 1 -->
                        <!-- Form Step 2 -->
                        <fieldset>
                            <button id="showMe" type="button" class="btn btn-next">Detect Current Location</button>
                            <div id="map"></div>
                            <div id="locationList"></div>
                            <h4>Address Information : <span>Step 2 - 4</span></h4>
                            <div class="form-group">
                                <label>Street Address: <span>*</span></label>
                                <textarea type="text" name="StreetAddress" id="StreetAddress" placeholder="Street Address" class="form-control required"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Local Name: <span>*</span></label>
                                <input type="text" name="LocalName" id="LocalName" placeholder="Local Place Name" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Tehsil: <span>*</span></label>
                                <input type="text" name="Tehsil" id="Tehsil" placeholder="Tehsil" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>District: <span>*</span></label>
                                <input type="text" name="District" id="District" placeholder="District" class="form-control required">
                            </div>
                            <!--
    <div class="form-group">
        <label>State: </label>
        <select class="form-control" id="State" name="State">
            <option value="">Select Status ...</option>
            <option value="AJK">Azad Jammu and Kashmir</option>
            <option value="BL">Balochistan</option>
            <option value="GB">Gilgit-Baltistan</option>
            <option value="ICT">Islamabad Capital Territory</option>
            <option value="KP">Khyber Pakhtunkhwa</option>
            <option value="PJ">Punjab</option>
            <option value="SN">Sindh</option>
        </select>
    </div>
        -->
                            <div class="form-group">
                                <label>State: <span>*</span></label>
                                <input type="text" name="State" id="State" placeholder="Province/State" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Portal Code: <span>*</span></label>
                                <input type="text" name="PostalCode" id="PostalCode" placeholder="Postal Code" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Lattitude: </label>
                                <input type="text" name="Lattitude" id="Lattitude" placeholder="Lattitude" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Longitude: </label>
                                <input type="text" name="Longitude" id="Longitude" placeholder="Longitude" class="form-control required">
                            </div>
                            <div class="form-wizard-buttons">
                                <button type="button" class="btn btn-previous">Previous</button>
                                <button type="button" class="btn btn-next">Next</button>
                            </div>
                        </fieldset>
                        <!-- Form Step 2 -->
                        <!-- Form Step 3 -->
                        <fieldset>

                            <h4>Official Information: <span>Step 3 - 4</span></h4>
                            <div class="form-group">
                                <label>Employee ID: <span>*</span></label>
                                <input type="text" name="Employee ID" placeholder="Employee ID" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Designation: <span>*</span></label>
                                <input type="text" name="Designation" placeholder="Designation" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Department: <span>*</span></label>
                                <input type="text" name="Department" placeholder="Department" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Working Hours: <span>*</span></label>
                                <input type="text" name="Working Hours" placeholder="Working Hours" class="form-control required">
                            </div>
                            <div class="container-fluid">
                                <div class="row form-inline">
                                    <div class="form-group col-md-3 col-xs-3">
                                        <label>Joining Date: </label>
                                    </div>
                                    <div class="form-group col-md-3 col-xs-3">
                                        <label>Day: </label>
                                        <select class="form-control">
                                            <option>01</option>
                                            <option>02</option>
                                            <option>03</option>
                                            <option>04</option>
                                            <option>05</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-md-3 col-xs-3">
                                        <label>Month: </label>
                                        <select class="form-control">
                                            <option>Jan</option>
                                            <option>Feb</option>
                                            <option>Mar</option>
                                            <option>Apr</option>
                                            <option>May</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-md-3 col-xs-3">
                                        <label>Year: </label>
                                        <select class="form-control">
                                            <option>2017</option>
                                            <option>2018</option>
                                            <option>2019</option>
                                            <option>2020</option>
                                            <option>2021</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <br />
                            <div class="form-wizard-buttons">
                                <button type="button" class="btn btn-previous">Previous</button>
                                <button type="button" class="btn btn-next">Next</button>
                            </div>
                        </fieldset>
                        <!-- Form Step 3 -->
                        <!-- Form Step 4 -->
                        <fieldset>

                            <h4>Payment Information: <span>Step 4 - 4</span></h4>
                            <div style="clear:both;"></div>
                            <div class="form-group">
                                <label>Bank Name: <span>*</span></label>
                                <input type="text" name="Bank Name" placeholder="Bank Name" class="form-control required">
                            </div>
                            <div class="form-group">
                                <label>Payment Type : </label>
                                <label class="radio-inline">
                                    <input type="radio" name="Payment" value="option1" checked="checked"> Master Card
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="Payment" value="option2"> Visa Card
                                </label>
                            </div>
                            <div class="form-group">
                                <label>Holder Name: <span>*</span></label>
                                <input type="text" name="Holder Name" placeholder="Holder Name" class="form-control required">
                            </div>
                            <div class="container-fluid">
                                <div class="row form-inline">
                                    <div class="form-group col-md-6 col-xs-6">
                                        <label>Card Number: <span>*</span></label>
                                        <input type="text" name="Card Number" placeholder="Card Number" class="form-control required">
                                    </div>
                                    <div class="form-group col-md-6 col-xs-6">
                                        <label>CVC: <span>*</span></label>
                                        <input type="text" name="CVC" placeholder="CVC" class="form-control required">
                                    </div>
                                </div>
                            </div>
                            <br />
                            <div class="container-fluid">
                                <div class="row form-inline">
                                    <div class="form-group col-md-3 col-xs-3">
                                        <label>Expiry Date: </label>
                                    </div>
                                    <div class="form-group col-md-3 col-xs-3">
                                        <label>Month: </label>
                                        <select class="form-control">
                                            <option>Jan</option>
                                            <option>Feb</option>
                                            <option>Mar</option>
                                            <option>Apr</option>
                                            <option>May</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-md-3 col-xs-3">
                                        <label>Year: </label>
                                        <select class="form-control">
                                            <option>2017</option>
                                            <option>2018</option>
                                            <option>2019</option>
                                            <option>2020</option>
                                            <option>2021</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <br />
                            <div class="form-wizard-buttons">
                                <button type="button" class="btn btn-previous">Previous</button>
                                <button type="submit" class="btn btn-submit">Submit</button>
                            </div>
                        </fieldset>
                        <!-- Form Step 4 -->

                    </form>
                    <!-- Form Wizard -->
                </div>
            </div>

        </div>
    </section>
    <script type="text/javascript">
        //This div will be used to show Google map
        const mapArea = document.getElementById('map');
        var lat;
        var lng;
        //const $ = id => document.getElementById(id);

        const actionBtn = document.getElementById('showMe');
        const locationsAvailable = document.getElementById('locationList');
        let Gmap, Gmarker;

        const __KEY = "AIzaSyAlQUvwpIS_6NdR01E8vHJDk3Z6h8hXNns";

        actionBtn.addEventListener('click', e => {
            // hide the button 
            actionBtn.style.display = "none";

            // call Materialize toast to update user 
            M.toast({ html: 'I am fetching your current location', classes: 'rounded' });

            // get the user's position
            getLocation();

        });

        getLocation = () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(displayLocation, showError, options)

            }
            else {
                M.toast({ html: 'Sorry, your browser does not support this feature... Please Update your Browser to enjoy it', classes: 'rounded' });
            }
        }

        // displayLocation
        displayLocation = (position) => {
            lat = position.coords.latitude;
            lng = position.coords.longitude;

            const latlng = { lat, lng }

            showMap(latlng, lat, lng);
            createMarker(latlng);
            mapArea.style.display = "block";
            getGeolocation(lat, lng);

        }

        // Recreates the map
        showMap = (latlng, lat, lng) => {
            let mapOptions = {
                center: latlng,
                zoom: 17
            };

            Gmap = new google.maps.Map(mapArea, mapOptions);

            Gmap.addListener('drag', function () {
                Gmarker.setPosition(this.getCenter()); // set marker position to map center
            });

            Gmap.addListener('dragend', function () {
                Gmarker.setPosition(this.getCenter()); // set marker position to map center
            });

            Gmap.addListener('idle', function () {

                Gmarker.setPosition(this.getCenter()); // set marker position to map center

                if (Gmarker.getPosition().lat() !== lat || Gmarker.getPosition().lng() !== lng) {
                    setTimeout(() => {
                        // console.log("I have to get new geocode here!")
                        updatePosition(this.getCenter().lat(), this.getCenter().lng()); // update position display
                    }, 2000);
                }
            });

        }

        // Creates marker on the screen
        createMarker = (latlng) => {
            let markerOptions = {
                position: latlng,
                map: Gmap,
                animation: google.maps.Animation.BOUNCE,
                clickable: true
                // draggable: true
            };
            Gmarker = new google.maps.Marker(markerOptions);

        }

        // updatePosition on 
        updatePosition = (lat, lng) => {

            getGeolocation(lat, lng);
        }

        // Displays the different error messages
        showError = (error) => {
            mapArea.style.display = "block"
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    mapArea.innerHTML = "You denied the request for your location."
                    break;
                case error.POSITION_UNAVAILABLE:
                    mapArea.innerHTML = "Your Location information is unavailable."
                    break;
                case error.TIMEOUT:
                    mapArea.innerHTML = "Your request timed out. Please try again"
                    break;
                case error.UNKNOWN_ERROR:
                    mapArea.innerHTML = "An unknown error occurred please try again after some time."
                    break;
            }
        }

        const options = {
            enableHighAccuracy: true
        }

        getGeolocation = (lat, lng) => {

            const latlng = lat + "," + lng;

            fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${latlng}&key=${__KEY}`)

                .then(res => res.json())
                .then(data => populateCard(data.results));

        }

        function removeAddressCards() {
            if (locationsAvailable.hasChildNodes()) {
                while (locationsAvailable.firstChild) {
                    locationsAvailable.removeChild(locationsAvailable.firstChild);
                }
            }
        }

        populateCard = (geoResults) => {
            // check if a the container has a child node to force re-render of dom
            removeAddressCards();

            geoResults.map(geoResult => {

                // first create the input div container
                const addressCard = document.createElement('div');

                // then create the input and label elements
                const input = document.createElement('input');
                const label = document.createElement('label');

                // then add materialize classes to the div and input
                addressCard.classList.add("card");
                input.classList.add("with-gap");

                // add attributes to them
                label.setAttribute("for", geoResult.place_id);
                label.innerHTML = geoResult.formatted_address;

                input.setAttribute("name", "address");
                input.setAttribute("type", "radio");
                input.setAttribute("value", geoResult.formatted_address);
                input.setAttribute("id", geoResult.place_id);
                // input.addEventListener('click', e => console.log(123));
                input.addEventListener('click', () => inputClicked(geoResult));
                // finalResult = input.value;
                finalResult = geoResult.formatted_address;


                addressCard.appendChild(input);
                addressCard.appendChild(label);

                // console.log(geoResult.formatted_address)

                return (
                    locationsAvailable.appendChild(addressCard)
                );
            })
        }

        inputClicked = (result) => {

            result.address_components.map(component => {
                const types = component.types

                if (types.includes('postal_code')) {
                    document.getElementById('PostalCode').value = component.long_name
                }

                if (types.includes('administrative_area_level_5')) {
                    document.getElementById('LocalName').value = component.long_name
                }
                if (types.includes('administrative_area_level_3')) {
                    document.getElementById('Tehsil').value = component.long_name
                }
                if (types.includes('administrative_area_level_2')) {
                    document.getElementById('District').value = component.long_name
                }

                if (types.includes('administrative_area_level_1')) {
                    document.getElementById('State').value = component.long_name
                }

                if (types.includes('point_of_interest')) {
                    document.getElementById('StreetAddress').value = component.long_name
                }
                document.getElementById("StreetAddress").value = result.formatted_address;
                document.getElementById("Lattitude").value = lat;
                document.getElementById("Longitude").value = lng;
            });
            //alert(result.formatted_address);
            
   
           // $('#StreetAddress').value = result.formatted_address;

            // to avoid labels overlapping prefilled contents
            M.updateTextFields();
            removeAddressCards();
        }
    </script>
</body>
</html>
